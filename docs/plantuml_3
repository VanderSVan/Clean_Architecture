@startuml
hide empty fields
hide circle
skinparam monochrome true

class users {
  +id: serial
  ..
  +role: varchar(50)
  ..
  +email: varchar(50)
  ..
  +password: varchar(25)
  ..
  +name: varchar(50)
  ..
  +nickname: varchar(50)
}

class patients {
  +id: serial
  ..
  +user_id: integer
  ..
  +age: integer | null
  ..
  +skin_type_id: integer | null
  ..
  +about: text | null
  ..
  +phone: integer | null
  ..
  +profile_photo_path: varchar(50) | null
}

class albums {
  +id: serial
  ..
  +name: varchar(50)
  ..
  +about: text | null
  ..
  +source_path: varchar(50)
  ..
  +patient_medical_history_id: integer [FK]
}

class photos {
  +id: serial
  ..
  +name: varchar(50) | null
  ..
  +about: text | null
  ..
  +source_path: varchar(50)
  ..
  +album_preview: boolean
  ..
  +album_id: integer [FK]
}

class symptoms {
  +id: serial
  ..
  +name: varchar(50)
}

class diagnoses {
  +id: serial
  ..
  +name: varchar(50)
}

class treatment_items {
  +id: serial
  ..
  +name: varchar(50)
  ..
  +category: text | null
  ..
  +type: text
  ..
  +price: decimal
}

class triggers {
  +id: serial
  ..
  +name: varchar(50)
}

class result_types {
  +id: serial
  ..
  +name: varchar(50)
}

class skin_types {
  +id: serial
  ..
  +name: varchar(50)
}

class patient_medical_histories {
  +id: serial
  ..
  +title: varchar(50)
  ..
  +history: text | null
  ..
  +patient_id: integer [FK]
  ..
  +diagnosis_id: integer [FK]
}
note top of patient_medical_histories : История болезни

class symptom_combinations{
  +id: serial
  ..
  +symptom_id: integer [FK]
  ..
  +patient_medical_history_id: integer [FK]
}

class trigger_combinations{
  +id: serial
  ..
  +trigger_id: integer [FK]
  ..
  +patient_medical_history_id: integer [FK]
}

class completed_treatment_protocols {
  +id: serial
  ..
  +start: timestamp | null
  ..
  +end: timestamp | null
  ..
  +about: text | null
  ..
  +usage_period: integer
  ..
  +patient_medical_history_id: integer [FK]
  ..
  +treatment_item_id: integer [FK]
  ..
  +treatment_item_rating: double precision
  ..
  +result_id: integer [FK]
}
note top of completed_treatment_protocols : Завершенный протокол лечения

patients::user_id --> users::id
patients::skin_type_id --> skin_types::id

albums::patient_medical_history_id --> patient_medical_histories::id

photos::album_id --> albums::id

symptom_combinations::symptom_id --> symptoms::id
symptom_combinations::patient_medical_history_id --> patient_medical_histories::id

trigger_combinations::trigger_id --> triggers::id
trigger_combinations::patient_medical_history_id --> patient_medical_histories::id

patient_medical_histories::patient_id --> patients::id
patient_medical_histories::diagnosis_id --> diagnoses::id

completed_treatment_protocols::patient_medical_history_id --> patient_medical_histories::id
completed_treatment_protocols::treatment_item_id --> treatment_items::id
completed_treatment_protocols::result_id --> result_types::id
@enduml