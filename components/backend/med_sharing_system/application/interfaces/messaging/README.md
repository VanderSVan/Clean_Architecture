## Пакет `messaging`

Этот пакет предоставляет абстрактные классы для очередей сообщений.
Пакет включает в себя инструменты для создания систем обмена сообщениями в Python с возможностью отложенной публикации. Он помогает структурировать сообщения, публиковать их и управлять процессом публикации в многопоточном окружении.

### Ключевые особенности

* **Определение сообщений:** Класс `Message` позволяет определять структуру сообщений с помощью полей `target` (получатель) и `body` (содержимое).
* **Асинхронная публикация:** Класс `Publisher` с абстрактным методом `publish` служит основой для создания издателей сообщений. Подклассы `Publisher` реализуют логику отправки сообщений по целевым адресам (очередям, почтовым ящикам и т.д.).
* **Отложенная публикация:** Метод `plan` позволяет добавлять сообщения в очередь для последующей публикации. Они отправятся все вместе при выходе из блока кода, использующего менеджер контекста `with`.
* **Потокобезопасность:** Пакет использует потокобезопасные структуры данных для работы в многопоточных приложениях.


### Использование

#### 1. Структура сообщений

```python
from messaging import Message

message = Message(target="user1@example.com", body="Привет!")
```

#### 2. Публикация сообщений

Для отправки сообщений необходимо создать `Publisher` и вызвать его метод `publish`. 

**Пример:**

```python
from messaging import Publisher, Message

class EmailPublisher(Publisher):
  def publish(self, *messages):
    # Реализовать логику отправки электронных писем по адресам из поля "target"
    print(f"Отправка электронных писем: {messages}")

publisher = EmailPublisher()
publisher.publish(Message("user1@example.com", "Привет!"))
publisher.publish(Message("user2@example.com", "Добро пожаловать!"))
```

#### 3. Отложенная публикация

Используйте менеджер контекста `with` для отложенной публикации сообщений. Сообщения, добавленные с помощью метода `plan`, отправятся все вместе при выходе из блока `with`.

**Пример:**

```python
from messaging import Publisher, Message

with Publisher() as publisher:
  publisher.plan(Message("user1@example.com", "Привет!"))
  publisher.plan(Message("user2@example.com", "Добро пожаловать!"))
```

**В этом примере сообщения отправятся только после выхода из блока `with`.**


### Дополнительные возможности

Пакет `messaging` предоставляет дополнительные возможности, такие как обработка исключений при публикации и расширенная конфигурация `Publisher`. Ознакомьтесь с исходным кодом для получения более подробной информации.
